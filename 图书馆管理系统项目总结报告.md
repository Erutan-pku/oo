# 图书馆业务系统项目总结报告

相关文档链接：

####甲方文档

*  [甲方需求文档](https://github.com/zhongyehong/oo-homework/blob/740f55bb10169b0eb114bfaa3e26101026b2a190/library.md ) 
*  [甲方需求变更文档](https://github.com/zhongyehong/oo-homework/blob/master/作业7/图书管理系统需求变更.md)

####乙方文档

*  [业务目标与涉众分析报告](https://github.com/Erutan-pku/oo/blob/86b3b8f7a5e7ceb09f158632ea108a970c3e2ddc/图书馆管理系统业务目标与涉众分析.md)
*  [需求分析报告](https://github.com/Erutan-pku/oo/blob/0782a53d173974d878e14c2c777d8342a6eb784d/图书馆管理系统需求分析报告.md)
*  [系统分析模型文档](https://github.com/Erutan-pku/oo/blob/master/图书馆管理系统系统分析报告.md)
*  [系统设计报告](https://github.com/Erutan-pku/oo/blob/master/图书馆管理系统系统设计报告.md)
*  [系统交付报告](https://github.com/Erutan-pku/oo/blob/master/图书馆管理系统系统交付报告.md)
*  [系统地址](http://59.108.48.17:8080/test_Library.html)

*  [需求变更后的第二轮开发文档](https://github.com/Erutan-pku/oo/blob/master/图书馆管理系统系统需求变更后的第二轮开发文档.md)

----

### 甲方需求

> 与甲方需求文档内容一致

##### 管理员:

管理员需要有一个管理员账户, 其中存储管理员的身份信息;

管理员可以查看所有用户的注册信息, 借阅(历史)信息, 图书馆座位状态信息.

管理员可以查看用户的欠费信息（图书损坏，借阅过期都会产生欠费）.

管理员可以查看用户的占座信用记录.

管理员可以创建一个用户账户或者删除一个用户账户或者重置用户账户.

管理员可以修改图书状态信息, 添加删除图书, 座位状态信息.

管理员可以给用户发送信息, 比如催还图书, 警告信息等.

管理员可以在系统中发布公告.

管理员可以对某些用户进行锁定或黑名单功能.

图书管理员可以查看统计报表等.

##### 用户:

可以创建账户, 修改个人信息, 注册登录.

可以查询当前图书信息，包括在图书馆的位置，借阅状态，图书摘要，价格等等.

可以根据书名、分类、作者等多种方式查找图书.

可以显示图书历史被借阅的次数.

可以查询当前座位信息，包括当前是否有人，是否有预约.

可以查阅自己的借阅状态, 借阅历史等，并且希望在借阅时间快结束时能有所提示，最好能在线续借.

可以网上预约图书, 可以取消预约，预约的图书如果还未归还，则在归还时通知用户.

可以网上选定座位, 可以取消选定.

可选且仅能选任何一个座位进行占座排队, 如果20分钟之内未到图书馆刷卡, 自动失去该座位, 排后者补位. 出门刷卡20分钟后自动释放该座位.

可以随时刷新看到座位状态信息, 显示前面多少位等待.

##### 其他要求:

用户丢失损坏图书需要赔偿.

连续三次占座不来进行警告或惩罚.

系统需要存储每本书的信息, 包括书名, 编号, 状态等.

系统应当产生日志等信息.

##### 用户在移动端进行处理, 图书管理员在PC端处理.

### 甲方需求变更情况

> 与甲方需求变更文档内容一致

* 新功能：按时间自动发邮件催还书籍

* 功能修改：从按书id搜索书籍变为书名搜索，并支持模糊搜

### 甲方实际情况调研

> 与相关工件内容一致

甲方情况与需求：

- 甲方图书馆属体制内单位，虽然馆藏书量不大，图书馆占地面积很小，自习区座位数很少，但满编制岗位足有8731人，除去各级管理岗位后仍有基层图书馆管理员6243人，有充足的人手手动对一些图书馆座位使用与书籍借阅的违规情况进行人工检查和系统录入。
- 图书馆管理系统并不需要和图书馆在岗人员的管理以及绩效考核挂钩。
- 国家有专门对对图书馆管理员计算机使用水平的培训，所以图书馆管理员的计算机水平可以放心。
- 因为图书馆管理人员充足，所以图书馆是24小时营业的。不过很多时候客户比较少，所以即使在更新一些东西时暂时停掉系统，对业务也没有很大影响。管理员比较多，所以很多操作都可以由管理员手动进行。
- 甲方图书馆中，所有图书和所有座位均已有统一编号。完全相同的书馆藏中只有一本，并且这条规则不会改变。
- 由于20年内无馆建计划，不打算对座位格局进行变更，所以不需要提供座位信息删改调整的接口，只需要在系统初始化时将座位信息表格导入到系统中即可。
- 图书检索方面只需要实现针对编号进行精确查找或者针对书名进行模糊查找即可。因为对图书馆管理员而言，编号是最方便的书籍代号；而对普通用户而言，他们也没有提出对书名之外的字段进行检索的需求，毕竟馆藏量不大，名称相似的书籍很少，一般也不会特意去记作者、出版社等字段。(其实这个问题更适合在需求分析过程中使用领域模型处理)
- 座位检索方面，图书馆的1~4层每层只有一个自习区，图书馆座位使用者表示只需要能够检索特定层的空座位就好了。因为图书馆自习区座位设计比较合理，并且每个自习区座位数不多，所以每个座位环境什么的差别不大。只是有些腿脚不太方便的用户在调查时表示，他们一般会更倾向于使用较低楼层的座位。还有些喜欢清静的用户在调查时表示，因为较高楼层很少有人路过，所以更倾向于使用较高楼层的座位。(其实这个问题更适合在需求分析过程中使用领域模型处理)
- 该图书馆所在国家最近正在大力推行一种公民统一账户系统，为每个国家公民提供一个账号，可以在所有地方应用。所以该甲方希望，该系统能且仅能以该账户的方式登录，包括普通用户和管理员用户。而该账户系统有提供统一的登录认证API。
- 由于图书馆管理员们的大力反对，甲方决定撤销该系统Q&A功能，决定以静态页面的形式呈现。具体页面的信息将由甲方的图书馆管理员们提供。
- 图书馆馆长在最近的调查中表示，之前所说的对违规者的处理方案太过仁慈了，所以甲方决定不对任何违规者宽容，内禀规则3、4修改成只要有一次违反相应规则，终生禁止其借书与使用座位的全部权利。
- 甲方认为，公告板应该对所有人可见，这样一方面，符合了图书馆管理员简单化管理流程的需求，另一方面面向所有用户公示催还书等信息也可以有效地起到督促作用。而且在最近进行的一项针对图书馆用户做的调查中，用户也表示理解与可以接受。

甲方的业务规则：

- [内禀规则-1] 预约座位，最多只可提前24小时预约。每次预约时间为1小时的整倍数，最多一次预约8小时。
- [内禀规则-2] 借书时间默认为3个月，不可变更。
- [内禀规则-3] 累计3次座位使用违规者(包括违约与使用超时)，停止其使用座位权限3天。第3+n次违规后，停止其使用座位权限3+n天(n=1,2,...,7)。超过10次违规者永久停止座位使用权限。
- [内禀规则-4] 累计3次图书借阅违规者(包括逾期不还与借书不取)，停止其借阅图书权限30天。第3+n次违规后，停止其使用座位权限30+10n天(n=1,2,...,7)。超过10次违规者永久停止借阅图书权限。
- [交互规则-1] 只有有权限的用户可以申请使用图书馆座位。
- [交互规则-2] 只有有权限的用户可以申请图书馆书籍借阅。
- [交互规则-3] 图书馆图书续借只能发生在借阅未超期时。
- [交互规则-4] 图书馆图书续借最长不超过3个月。续借时间为月的整倍数。



* 当用户登录时，自动检查用户的书籍借阅情况，如果有一月内到期书籍，则进行提醒。

* 增加针对书名的检索，并且该检索支持模糊匹配，查询返回书名包含查询内容的结果。

### 系统设计类图

> 与系统设计报告内容一致

![image](https://github.com/Erutan-pku/oo/blob/master/pic/设计类图.png?raw=true)

### 系统实现

设计类图中，除了左上的与座位相关的部分以及右上的与公告相关的部分，其余均已实现。
以下仅列出已实现部分的功能。

##### 前端请求

* 获取当前登录账户信息
* 获取当前登录账户即将到期的书籍信息

> 属于需求变更内容

##### 用户操作

* 登录(未注册的自动注册)
* 登出
* 根据书籍ID查询书籍信息
* 根据书籍名称模糊查询书籍信息

> 属于需求变更内容

* 获取图书馆全部书单
* 查询自己借阅的书籍信息
* 查询自己即将到期的书籍信息
* 续借

##### 管理员权限操作

* 修改指定用户借书权限(设置惩罚)
* 添加书籍信息
* 删除书籍信息
* 查询指定用户的借阅信息
* 借书登记
* 还书登记

##### 内网总管操作

> 该操作仅限于图书馆内网下使用超级密码登录后进行

* 变更用户管理员权限


### 实现过程分析

由于系统设计模型详尽到位，系统实现过程中基本按照设计类图实现，并未有较大出入。
主要还是一个MVC实现，视图部分用的是最简单的js的alert函数将运行结果的Json数据弹出。控制器部分使用JQuery和Java Servlet实现，将需求以post的形式发到后端，然后后端解析需求执行逻辑并以Json的格式返回结果。模型部分由java实现，系统启动时从数据库中恢复出上次运行系统时的信息，并在数据发生更改时实时更新数据库。数据库使用mysql，在mysqldb的基础上封装一层数据库操作接口供逻辑实现部分调用。

### 技术难题

并没有遇到太大的技术难题。因为业务逻辑较为复杂，所以在系统设计时对每一个子系统设计一个集体的概念，方便管理。例如将很多用户抽象成用户群，将很多书籍抽象成书区等等，有助于检索等。这也有助于以后的图书馆的模块化扩展，比如成立分管、开放外籍人员特殊管理体系等等。

遇到比较复杂的需求，积极和甲方沟通，可以根据甲方的实际情况定制实现方案，简化需求实现的难度。

### 系统连接

* 目前系统在这里运行：[运行地址](http://59.108.48.17:8080/test_Library.html)
* 系统源代码的[地址](https://github.com/Erutan-pku/oo/tree/master/Library)

### 课程总结

* 作为一名本科来自智能系，研究生阶段也主要研究自然语言处理的学生，之前基本没有接触过软件工程以及复杂的系统设计与系统分析，这门课程使我领略到了软件工程的魅力。
* 通过这门课程的学习，使我对面向对象的流程和方法有了更加全面的了解。了解了OOA与OOD的一些基本流程和方法，知道了设计模式的设计背景和应用模式，掌握了一些常用UML图的绘制方式及常见问题。

